<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadora de Ritmos de Carrera</title>
  <!-- Tipografía Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      font-family: "Poppins", system-ui, sans-serif;
      --primary: #e53935;
      --primary-dark: #c62828;
    }
    body {
      display:flex;flex-direction:column;justify-content:flex-start;align-items:center;min-height:100vh;margin:0;background:#000;padding:3rem 2rem 4rem;gap:1.5rem;color:#eee;
    }
    h1{margin:0;font-size:2rem;color:var(--primary);text-align:center;line-height:1.05;}
    .subtitle{margin:0;text-align:center;max-width:480px;font-size:.95rem;color:#fff;}
    .calculator{background:#fff;padding:2rem;border-radius:1rem;box-shadow:0 6px 20px rgba(0,0,0,.25);display:grid;gap:1rem;width:min(90%,400px);border-top:6px solid var(--primary);color:#222;}
    label{display:flex;flex-direction:column;font-weight:600;font-size:.9rem;}
    .label-text{white-space:nowrap;}
    input,select{margin-top:.35rem;padding:.55rem .9rem;font-size:1rem;border:1px solid #d0d0d0;border-radius:.5rem;font-family:inherit;transition:border-color .2s,box-shadow .2s;}
    input:focus,select:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 2px rgba(229,57,53,.4);}select{background:#fff;}
    .btn-unit{align-self:center;margin-top:.5rem;background:var(--primary);color:#fff;border:none;padding:.7rem 1.4rem;font-size:.95rem;border-radius:.5rem;cursor:pointer;transition:background .2s;font-weight:600;}
    .btn-unit:hover{background:var(--primary-dark);}
    @media(min-width:600px){body{padding-left:1.25rem;padding-right:1.25rem;}}
  </style>
</head>
<body>
  <h1>Calculadora de Ritmos de Carrera</h1>
  <p class="subtitle">
    Ingresa <strong>solo uno</strong> de los tres campos (Distancia, Tiempo o Pace) y los otros dos se completarán automáticamente.<br />
    Si lo prefieres, elige una distancia típica en el desplegable.
  </p>

  <div class="calculator">
    <label>
      <span class="label-text">Distancia (<span id="distanceUnit">km</span>)</span>
      <input type="number" id="distance" step="0.001" value="10" />
    </label>

    <label>
      Distancia típica
      <select id="distancePreset">
        <option value="">-- Selecciona --</option>
        <option value="42.195">Maratón (42.195 km)</option>
        <option value="21.0975">Medio Maratón (21.0975 km)</option>
        <option value="15">15 km</option>
        <option value="12">12 km</option>
        <option value="10">10 km</option>
        <option value="5">5 km</option>
      </select>
    </label>

    <label>
      Tiempo (HH:MM:ss)
      <input type="text" id="time" value="01:00:00" pattern="\d{1,2}:\d{2}:\d{2}" />
    </label>

    <label>
      <span class="label-text">Pace (min/<span id="paceUnit">km</span>)</span>
      <input type="text" id="pace" value="06:00" pattern="\d{1,2}:\d{2}" />
    </label>

    <button id="unitToggle" class="btn-unit">Cambiar a Millas</button>
  </div>

<script>
// ---------- DOM refs ----------
const distanceInput = document.getElementById('distance');
const timeInput      = document.getElementById('time');
const paceInput      = document.getElementById('pace');
const distancePreset = document.getElementById('distancePreset');
const unitToggle     = document.getElementById('unitToggle');
const distanceUnitSpan = document.getElementById('distanceUnit');
const paceUnitSpan     = document.getElementById('paceUnit');

// ---------- Constantes ----------
const KM_TO_MI = 0.621371;
const MI_TO_KM = 1 / KM_TO_MI;
const KM_PER_MI = 1.60934;
let isMetric = true;

// ---------- Helper time/pace ----------
const pad = n => String(n).padStart(2,'0');
const hhmmssToSeconds = str => { const [h=0,m=0,s=0]=str.split(':').map(Number); return h*3600+m*60+s; };
const secondsToHHMMSS = sec => { const h=Math.floor(sec/3600),m=Math.floor(sec%3600/60),s=Math.round(sec%60); return `${pad(h)}:${pad(m)}:${pad(s)}`; };
const mmssToSeconds   = str => { const [m=0,s=0]=str.split(':').map(Number); return m*60+s; };
const secondsToMMSS   = sec => { const m=Math.floor(sec/60),s=Math.round(sec%60); return `${pad(m)}:${pad(s)}`; };

// ---------- Sincronizaciones ----------
function calcPace(){
  const dist=parseFloat(distanceInput.value);
  const timeSec=hhmmssToSeconds(timeInput.value);
  if(isFinite(dist)&&dist>0&&isFinite(timeSec)&&timeSec>0){
    paceInput.value=secondsToMMSS(timeSec/dist);
  }
}
function calcTime(){
  const dist=parseFloat(distanceInput.value);
  const paceSec=mmssToSeconds(paceInput.value);
  if(isFinite(dist)&&dist>0&&isFinite(paceSec)&&paceSec>0){
    timeInput.value=secondsToHHMMSS(dist*paceSec);
  }
}

// Inicial
calcPace();

// Eventos
 distanceInput.addEventListener('input',calcTime);
 timeInput.addEventListener('input',calcPace);
 paceInput.addEventListener('input',calcTime);

 distancePreset.addEventListener('change',()=>{
   if(!distancePreset.value) return;
   let val=parseFloat(distancePreset.value);
   if(!isMetric) val*=KM_TO_MI; // convertir si estamos en millas
   distanceInput.value=val.toFixed(3);
   distanceInput.dispatchEvent(new Event('input',{bubbles:true}));
 });

// ---------- Conversión de unidades ----------
function toMiles(){
  const dist=parseFloat(distanceInput.value);
  const pace=mmssToSeconds(paceInput.value);
  if(isFinite(dist)) distanceInput.value=(dist*KM_TO_MI).toFixed(3);
  if(isFinite(pace)) paceInput.value=secondsToMMSS(pace*KM_PER_MI);
  distanceUnitSpan.textContent='mi';
  paceUnitSpan.textContent='mi';
  unitToggle.textContent='Cambiar a Kms';
  isMetric=false;
}
function toKilometers(){
  const dist=parseFloat(distanceInput.value);
  const pace=mmssToSeconds(paceInput.value);
  if(isFinite(dist)) distanceInput.value=(dist*MI_TO_KM).toFixed(3);
  if(isFinite(pace)) paceInput.value=secondsToMMSS(pace/KM_PER_MI);
  distanceUnitSpan.textContent='km';
  paceUnitSpan.textContent='km';
  unitToggle.textContent='Cambiar a Millas';
  isMetric=true;
}
unitToggle.addEventListener('click',()=>{
  isMetric ? toMiles() : toKilometers();
});
</script>
</body>
</html>
